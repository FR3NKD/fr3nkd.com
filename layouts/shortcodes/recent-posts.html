{{- $limit := .Get "limit" | default 3 -}}
{{- $pages := where site.RegularPages "Type" "blog" -}}
{{- $pages = $pages | intersect (where site.RegularPages "IsPage" true) -}}
{{- $pages = $pages.ByDate.Reverse | first $limit -}}

<div class="hx:mt-6 hx:mb-10">
    {{- range $pages }}
    <div class="hx:mb-8 hx:flex hx:flex-col hx:md:flex-row hx:gap-2 hx:items-start">

        {{- $images := findRE `!\[.*?\]\((.*?)\)` .RawContent -}}
        {{- if gt (len $images) 0 -}}
        {{- $src := replaceRE `!\[.*?\]\((.*?)\)` "$1" (index $images 0) -}}
        <a href="{{ .RelPermalink }}"
            class="hx:shrink-0 hx:w-full hx:md:w-48 hx:aspect-video hx:md:h-32 hx:overflow-hidden hx:rounded hx:block">
            <img src="{{ $src }}" alt="{{ .Title }}" class="hx:w-full hx:h-full hx:object-cover" />
        </a>
        {{- end -}}

        <div class="hx:flex-1 hx:min-w-0">
            <h3>
                <a class="hx:block hx:font-bold hx:text-3xl hx:!text-slate-900 hx:dark:!text-slate-100 hx:!no-underline"
                    href="{{ .RelPermalink }}">
                    {{ .Title }}
                </a>
            </h3>
            <p class="hx:opacity-80 hx:mt-2 hx:text-sm hx:leading-6">{{ .Summary | plainify | truncate 120 }}</p>
            <div class="hx:flex hx:items-center hx:gap-2 hx:mt-3 hx:text-sm">
                <span class="hx:opacity-50 hx:font-mono hx:text-xs">{{ .Date.Format "January 2, 2006" }}</span>
                <span class="hx:opacity-20">•</span>
                <a class="hx:text-[color:hsl(var(--primary-hue),100%,50%)] hx:font-medium hx:!no-underline"
                    href="{{ .RelPermalink }}">Read more →</a>
            </div>
        </div>
    </div>
    {{ end -}}
</div>